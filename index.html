<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Food Vis</title>
<link rel="stylesheet" type="text/css" href="css/map.css"/>
<script type="text/javascript" src="./js/vendor/d3.v3.min.js"></script>
<script type="text/javascript" src="./js/vendor/jquery-3.1.1.min.js"></script>
<script type="text/javascript">
var statesAlpha = {
    "AL": 1,
    "AK": 2,
    "AZ": 3,
    "AR": 4,
    "CA": 5,
    "CO": 6,
    "CT": 7,
    "DE": 8,
    "DC": 9,
    "FL": 10,
    "GA": 11,
    "HI": 12,
    "ID": 13,
    "IL": 14,
    "IN": 15,
    "IA": 16,
    "KS": 17,
    "KY": 18,
    "LA": 19,
    "ME": 20,
    "MD": 21,
    "MA": 22,
    "MI": 23,
    "MN": 24,
    "MS": 25,
    "MO": 26,
    "MT": 27,
    "NE": 28,
    "NV": 29,
    "NH": 30,
    "NJ": 31,
    "NM": 32,
    "NY": 33,
    "NC": 34,
    "ND": 35,
    "OH": 36,
    "OK": 37,
    "OR": 38,
    "PA": 39,
    "RI": 40,
    "SC": 41,
    "SD": 42,
    "TN": 43,
    "TX": 44,
    "UT": 45,
    "VT": 46,
    "VA": 47,
    "WA": 48,
    "WV": 49,
    "WI": 50,
    "WY": 51
};
$(document).ready(function() {
    var states = {};
    var graph = $('#arcGraph');
    // Deep Copy alphabetical into the current active and setup states
    Object.keys(statesAlpha).forEach(function(key) {
        states[ key ] = statesAlpha[ key ];
        graph.append(
            $(document.createElementNS("http://www.w3.org/2000/svg", "g")).attr('id', key+'StateBox')
                .addClass('state').attr('transform', 'translate('+((states[ key ]-1)*25+2)+',417)')
                .append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "rect"))
                        .attr('x', 0).attr('y', 33).attr('width',24).attr('height', 19)
                )
                .append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "text"))
                        .attr('x', 12).attr('y', 47).text(key).attr('text-anchor', 'middle')
                )
        );
    });
    
    // Add Some Dots :)
    Object.keys(states).forEach(function(key) {
        $('#'+key+'StateBox').append(
            $(document.createElementNS("http://www.w3.org/2000/svg", "g")).attr('id', key+'DotsBox')
                .addClass('dots').attr('transform', 'translate(0,61)')
        ).append(
            // Add the Big Circle
            $(document.createElementNS("http://www.w3.org/2000/svg", "circle")).attr('id', key+'ToSelf')
                .attr('cx', 12)
                .attr('cy', 8).attr('r', getRandomInt(1,8)).addClass('stateCircle')
        );
            //if (key == 'AL') {
            //    $('#'+key+'StateBox').addClass('state1');
            //}
        var box = $('#'+key+'DotsBox');
        var importDots = states[key] + getRandomInt(-3,3);
        if (importDots < 0) {
            importDots = 0;
        }
        var exportDots = Math.abs(30-states[key]) + getRandomInt(-3,3);
        if (importDots + exportDots > 50) {
            exportDots = 60 - importDots;
        }
        for (var i = 0; i < importDots; i++) {
            addDot(box, i, 0, 'import');
        }
        for (var i = 0; i < exportDots; i++) {
            addDot(box, i, importDots, 'export');
        }
    });
    
    $('#backwards').click(function () {
        // Reverse states
        Object.keys(states).forEach(function(key) {
            states[ key ] = (states[key] - 52)*-1;
            $('#'+key+'StateBox').attr('transform', 'translate('+((states[key]-1)*25+2)+',417)');
            //if (key == 'AL') {
            //    $('#'+key+'StateBox').addClass('state2').removeClass('state1');
            //}
        });
    });
});
function getRandomInt(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min)) + min;
}
function addDot(box, i, extra, className) {
    box.append(
        $(document.createElementNS("http://www.w3.org/2000/svg", "circle"))
            .attr('cx', ((i + extra) % 5) * 4 + 4)
            .attr('cy', Math.floor((i+extra)/5) * 4).attr('r', 1.5).addClass(className)
    );
}
</script>
</head>
<body>
<button id="backwards">Backwards</button>
<div id="header">
    <!-- https://github.gatech.edu/lklingman3/info-vis/issues/4 -->
    <h1 style="float:left;">Food Flow Mapper</h1>
    <select id="stateSelect">
        <option value="all">All</option>
        <option value="GA" selected>GA - Georgia</option>
    </select>
    <select id="viewSelect">
        <option value="weight">Shipment Weight</option>
        <option value="value">Shipment Value</option>
        <option value="number">Number of Shipments</option>
        <option value="distance">Shipment Distance</option>
    </select>
    
    <p>
        Sort By: <b>Alphabet</b> Ranking
        Filter By:
            <select id="filterFood"><option value="all">All Food Types</option></select>
            <select id="filterTrans"><option value="all">All Transportation Types</option></select>
        Shade By:
            <select id="shade"><option value="ie">Import and Export</option></select>
    </p>
    <div id="yearSelect">
        <!-- This should have the bar graph, slider, and back/play/forward buttons -->
        <!-- Font Awesome http://fontawesome.io/ might be good for the icons. -->
    </div>
</div>
<div id="arcsAndDots">
    <!-- https://github.gatech.edu/lklingman3/info-vis/issues/5 -->
    <svg id='arcGraph'>
        <g class='gray-arc'>
        <!--A rx ry x-axis-rotation large-arc-flag sweep-flag x y-->
            <!-- must adjust the move by half of stroke width -->
            <path d = "M 14 425 a 1.5 1 0 0 1 100 0" class="import-line" stroke-width="5"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 100 0" class="export-line" stroke-width="2"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 400 0" class="export-line" stroke-width="7"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 400 0" class="import-line" stroke-width="4"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 1000 0" class="import-line" stroke-width="5"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 1000 0" class="export-line" stroke-width="2"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 1250 0" class="import-line" stroke-width="8"/>
            <path d = "M 14 425 a 1.5 1 0 0 1 1250 0" class="export-line" stroke-width="1"/>
            <path d = "M 114 425 a 1.5 1 0 0 1 400 0" class="export-line" stroke-width="7"/>
            <path d = "M 114 425 a 1.5 1 0 0 1 400 0" class="import-line" stroke-width="4"/>
        </g>
    </svg>
</div>
<div id="bottomRow">
    <div id="map">
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/1 -->
        <div id="mapSC" style="top: 200px; left:30px;">SC</div>
    </div>
    <div id="foodClassBar">
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/2 -->
        <!-- Complete using flot (http://www.flotcharts.org/flot/examples/stacking/index.html) or D3 -->
    </div>
    <div id="transportationBar">
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/3 -->
        <!-- Complete using flot (http://www.flotcharts.org/flot/examples/stacking/index.html) or D3 -->
    </div>
</div>
</body>
</html>