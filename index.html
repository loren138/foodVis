<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Food Vis</title>
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,500|Roboto+Condensed:400,700|Roboto:300,400" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./js/vendor/selectize/selectize.css"/>
    <link rel="stylesheet" type="text/css" href="./css/styles.css"/>
    <link rel="stylesheet" type="text/css" href="./css/states.css"/>
    <script type="text/javascript" src="./js/vendor/d3.v3.min.js"></script>
    <script type="text/javascript" src="./js/vendor/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="./js/vendor/selectize/selectize.js"></script>
    <script type="text/javascript" src="./js/vendor/alasql.min.js"></script>
    <script type="text/javascript">
        var stateSum;
        var ready = 1;
        var stateFlow;
        alasql("CREATE TABLE stateFlow (t string, s string, fo string, tr string, v number, w number, tm number)");

        /*$.getJSON('./data/2012/state_sum_all.json', function(json){
            stateSum = json;
            ready++;
        });*/
        $.getJSON('./data/2012/state_flow.json', function(json){
            alasql.tables.stateFlow.data = json;
            ready++;
        });

var statesAlpha = {
    "AL": 1,
    "AK": 2,
    "AZ": 3,
    "AR": 4,
    "CA": 5,
    "CO": 6,
    "CT": 7,
    "DE": 8,
    "DC": 9,
    "FL": 10,
    "GA": 11,
    "HI": 12,
    "ID": 13,
    "IL": 14,
    "IN": 15,
    "IA": 16,
    "KS": 17,
    "KY": 18,
    "LA": 19,
    "ME": 20,
    "MD": 21,
    "MA": 22,
    "MI": 23,
    "MN": 24,
    "MS": 25,
    "MO": 26,
    "MT": 27,
    "NE": 28,
    "NV": 29,
    "NH": 30,
    "NJ": 31,
    "NM": 32,
    "NY": 33,
    "NC": 34,
    "ND": 35,
    "OH": 36,
    "OK": 37,
    "OR": 38,
    "PA": 39,
    "RI": 40,
    "SC": 41,
    "SD": 42,
    "TN": 43,
    "TX": 44,
    "UT": 45,
    "VT": 46,
    "VA": 47,
    "WA": 48,
    "WV": 49,
    "WI": 50,
    "WY": 51
};
var arcData, graph, states, dotsIndex;
var stateSumNorm = { // What to divide by for states
    // [ 'forDots', 'forSelfDots', 'forArcWidth', 'forStateColor', 'forPopup']
    'w': [8000, 1500, 500, 15000, 1000],
    'v': [5000, 1500, 500, 5000, 1000],
    'tm': [2000000000, 750000000, 500000000, 1500000000, 1000000000]
};
function waitForData() {
    if (ready != 2) {
        setTimeout(waitForData, 500);
    } else {
        setUp();
    }
}
function drawArcs() {
    // Draw Arcs
    var arcG = graph.find('.gray-arc');
    arcG.empty(); // Remove all children
    //for (var i = 0; i < arcData.length; i++) {
    for (var i = 0; i < arcData.length; i++) {
        if (arcData[i]['s'] == arcData[i]['t']) {
            // Draw Circle
            // TODO: Normalize to area and change to total weight of all, when selected show this number as an outer ring
            // TODO: and limit dot size more
            //var size = Math.round(arcData[i][dotsIndex]/stateSumNorm[dotsIndex][1]*10)/10;
        } else {
            // Draw Arc
            var size = Math.round(arcData[i]['w']/stateSumNorm[dotsIndex][2]*10)/10;
            if (size < 1) {
                size = 1;
            } else if (size > 20) {
                size = 20
            }
            var state1 = states[arcData[i]['t']]*25-25+14;
            var state2 = states[arcData[i]['s']]*25-25+14;
            var xmove = 0;
            if (state1 < state2) {
                xmove = state2-state1;
            } else {
                xmove = state1 - state2;
                state1 = state2;
            }
            arcG.append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "path"))
                    //.attr('id', arcData[i]['s']+'ToSelf')
                            .attr('class', 'import-line import-'+arcData[i]['t']+' export-'+arcData[i]['s'])
                            // rx ry x-axis-rotation large-arc-flag sweep-flag x y
                            .attr('d', 'M '+state1+' 425 a 1.5 1 0 0 1 '+xmove+' 0')
                            .attr('stroke-width', size)

            );
        }
    }
}

function queryWhere() {
    var f = $('#filterFood').val();
    var t = $('#filterTrans').val();
    var query = '';
    if (t != 'all') {
        query = 'WHERE tr IN (\''+t.split(',').join("','")+'\')'
    }
    if (f != 'all') {
        if (query != '') {
            query += ' AND ';
        } else {
            query = 'WHERE ';
        }
        query += 'fo = \''+f+'\''
    }

    return query;
}
var stateRankI;
var stateRankE;
function computeRanks() {
    var stateRankIa = [];
    var stateRankEa = [];
    Object.keys(states).forEach(function (key) {
        stateRankIa.push([stateSum[key]['i'], key]);
        stateRankEa.push([stateSum[key]['e'], key]);
    });
    stateRankIa.sort(function (a, b) { return b[0]-a[0]; });
    stateRankEa.sort(function (a, b) { return b[0]-a[0]; });
    stateRankI = {};
    stateRankE = {};
    for (var i = 0; i < stateRankIa.length; i++) {
        stateRankI[stateRankIa[i][1]] = i+1;
    }
    for (i = 0; i < stateRankEa.length; i++) {
        stateRankE[stateRankEa[i][1]] = i+1;
    }
}

function sortStates() {
    // Reverse states
    var val = $('#sortSelect').val();

    if (val != 'alphabet') {
        var stateRanka = [];
        Object.keys(states).forEach(function (key) {
            stateRanka.push([stateSum[key]['i'] + stateSum[key]['e'], key]);
        });
        stateRanka.sort(function (a, b) {
            return b[0] - a[0];
        });
        var stateRank = {};
        for (var i = 0; i < stateRanka.length; i++) {
            stateRank[stateRanka[i][1]] = i+1;
        }
    }
    Object.keys(states).forEach(function(key) {
        if (val == 'alphabet') {
            states[key] = statesAlpha[key];
        } else {
            states[key] = stateRank[key];
        }
        $('#'+key+'StateBox').attr('class', 'state state'+states[key]);
        //.addClass('state'+states[key])
        //.attr('transform', 'translate('+((states[key]-1)*25+2)+',417)');
        //if (key == 'AL') {
        //    $('#'+key+'StateBox').addClass('state2').removeClass('state1');
        //}
    });
    drawArcs();
}

function stateSumCalc() {
    var data1 = alasql('SELECT s, SUM('+dotsIndex+') AS w FROM stateFlow '+queryWhere()+' GROUP BY s');
    var data2 = alasql('SELECT t, SUM('+dotsIndex+') AS w FROM stateFlow '+queryWhere()+' GROUP BY t');
    stateSum = {};
    Object.keys(statesAlpha).forEach(function(key) {
        stateSum[key] = {'e': 0, 'i': 0}
    });

    for (var i = 0; i < data1.length; i++) {
        stateSum[data1[i].s]['e'] = data1[i]['w']
    }
    for (i = 0; i < data2.length; i++) {
        stateSum[data2[i].t]['i'] = data2[i]['w']
    }
}
function drawDots() {
    stateSumCalc();

    Object.keys(states).forEach(function(key) {
        var size = Math.round((stateSum[key]['i'] + stateSum[key]['e'])/stateSumNorm[dotsIndex][1])/10;
        if (size < 3) {
            size = 3;
        }
        if (size > 10) {
            size = 10
        }
        var selfCircle = $('#'+key+'ToSelf');
        if (selfCircle.length) {
            selfCircle.attr('r', size);
        } else {
            $('#' + key + 'StateBox').append(
                    // Add the Big Circle
                    $(document.createElementNS("http://www.w3.org/2000/svg", "circle")).attr('id', key + 'ToSelf')
                            .attr('cx', 12).data('state', key)
                            .attr('cy', 8).attr('r', size).addClass('stateCircle')
            );
        }

        var box = $('#'+key+'DotsBox');

        if (box.length) {
            box.empty();
        } else {
            $('#' + key + 'StateBox').append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "g")).attr('id', key + 'DotsBox')
                            .addClass('dots').attr('transform', 'translate(0,61)')
            );
            box = $('#'+key+'DotsBox');
        }
        var importDots = Math.round(stateSum[key]['i']/stateSumNorm[dotsIndex][0]);
        if (importDots < 0) {
            importDots = 0;
        }
        var exportDots = Math.round(stateSum[key]['e']/stateSumNorm[dotsIndex][0]);
        //if (importDots + exportDots > 50) {
        //    exportDots = 60 - importDots;
        //}
        for (var i = 0; i < importDots; i++) {
            addDot(box, i, 0, 'import');
        }
        for (var i = 0; i < exportDots; i++) {
            addDot(box, i, importDots, 'export');
        }
        var x = Math.round(stateSum[key]['i']/stateSumNorm[dotsIndex][3]);
        if (x < 1) {
            x = 1;
        }
        if (x > 6) {
            x = 6;
        }
        $('#stateMap'+key+' rect').attr('class', 'mapColor'+x);
    });
}
var stateAbbr = {};
$(document).ready(waitForData);
function setUp() {
    var selectList = {};
    $.each($('.selectbox'), function(){
        var $this = $(this);
        selectList[$this.attr('id')] = $this.selectize({
            create: true
        });
    });

    $.getJSON('./data/codeToState.json', function(json){
        var stateList = json;
        $.each(stateList, function(index, item){
            item.text = item.abbreviation + '-' + item.name;
            item.value = item.abbreviation;
            stateAbbr[item.abbreviation] = item.name;
        });

        selectList.stateSelect[0].selectize.addOption(stateList);
    });

    states = {};
    graph = $('#arcGraph');
    // Deep Copy alphabetical into the current active and setup states
    Object.keys(statesAlpha).forEach(function(key) {
        states[ key ] = statesAlpha[ key ];
        graph.append(
            $(document.createElementNS("http://www.w3.org/2000/svg", "g")).attr('id', key+'StateBox')
                    .attr('class', 'state state'+states[key])
                    //.attr('transform', 'translate('+((states[ key ]-1)*25+2)+',417)')
                .append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "rect")).attr('class', 'stateRect')
                        .attr('x', 0).attr('y', 33).attr('width',24).attr('height', 19).data('state', key)
                )
                .append(
                    $(document.createElementNS("http://www.w3.org/2000/svg", "text")).attr('class', 'stateText')
                        .attr('x', 12).attr('y', 47).text(key).attr('text-anchor', 'middle').data('state', key)
                )
        );
    });
    dotsIndex = $('#viewSelect').val();
    redraw();

    $('#filterFood, #filterTrans').change(redraw);
    $('#viewSelect').change(viewChange);
    $('#sortSelect').change(sortStates);
}
function viewChange() {
    dotsIndex = $('#viewSelect').val();
    var optText = $("#viewSelect option:selected").text();
    $('.viewSelectText').text(optText);
    if (dotsIndex == 'w') {
        $('.keyUnits').text('In Billions of Pounds');
        $('#mapKey1').text('30');
        $('#mapKey2').text('60');
        $('#mapKey3').text('> 90');
    } else if (dotsIndex == 'v') {
        $('.keyUnits').text('In Billions of Dollars');
        $('#mapKey1').text('10');
        $('#mapKey2').text('20');
        $('#mapKey3').text('> 30');
    } else {
        $('.keyUnits').text('In Billions of Ton Miles');
        $('#mapKey1').text('3');
        $('#mapKey2').text('6');
        $('#mapKey3').text('> 9');
    }
    redraw();
}
function redraw() {
    arcData = alasql('SELECT s, t, SUM('+dotsIndex+') AS w FROM stateFlow '+queryWhere()+' GROUP BY s, t');
    drawDots();
    sortStates();
    drawArcs();
    computeRanks();
    $('.stateCircle, .stateText').hover(stateHoverIn, stateHoverOut);
}
function stateHoverIn() {
    var item = $('#hoverState');
    var state = $(this).data('state');
    item.css('left', states[state]*25-25-50);
    $('#hoverImport').text((stateSum[state]['i'] / stateSumNorm[dotsIndex][4]).toPrecision(3));
    $('#hoverExport').text((stateSum[state]['e'] / stateSumNorm[dotsIndex][4]).toPrecision(3));
    $('#hoverImportRank').text(stateRankI[state]);
    $('#hoverExportRank').text(stateRankE[state]);
    $('#hoverStateName').text(stateAbbr[state]);
    //$('#hoverStateName').text(state+' - '+ stateAbbr[state]);
    //item.stop().fadeIn(200);
    item.show();
}
function stateHoverOut() {
    //$('#hoverState').stop().show(200);
    $('#hoverState').hide();
}
function addDot(box, i, extra, className) {
    box.append(
        $(document.createElementNS("http://www.w3.org/2000/svg", "circle"))
            .attr('cx', ((i + extra) % 5) * 4 + 4)
            .attr('cy', Math.floor((i+extra)/5) * 4).attr('r', 1.5).addClass(className)
    );
}
</script>
</head>
<body>
<div id="header" class="header noselect">
    <!-- https://github.gatech.edu/lklingman3/info-vis/issues/4 -->
    <h1 class="logo">Food Flow Mapper</h1>
    <form autocomplete="off">
    <div class="filter">
        <select class="selectbox" id="stateSelect">
            <option value="all" selected>All States</option>
        </select>
        <select class="selectbox selectbox-mid" id="viewSelect">
            <option value="w" selected>Shipment Weight</option>
            <option value="v">Shipment Value</option>
            <option value="tm">Ton Miles</option>
        </select>
        <span class="sort-by">
            <label class="label">Sort by</label>
            <select class="selectbox" id="sortSelect">
                <option value="alphabet" selected>Alphabet</option>
                <option value="ranking">Ranking</option>
            </select>
        </span>
        <span class="filter-by">
            <label class="label">Filter by</label>
            <select class="selectbox selectbox-mid" id="filterFood">
                <option value="all" selected>All Food Types</option>
                <option value="F01">Animals and Fish</option>
                <option value="F02">Cereal Grains</option>
                <option value="F03">Agricultural Products</option>
                <option value="F04">Animal Feed, Eggs, Honey, and Other product of Animal Origin</option>
                <option value="F05">Meat, Poultry, Fish, Seafood, and their preparations</option>
                <option value="F06">Milled Grain Products and Preparations, and Bakery Products</option>
                <option value="F07">Other Prepared Foodstuffs, and Fats and Oil</option>
                <option value="F08">Alcoholic Beverages and Denatured Alcohol</option>
                <option value="F09">Tobacco Products</option>
                <option value="F00">Other Undefined food</option>
            </select>
            <select class="selectbox selectbox-mid" id="filterTrans">
                <option value="all" selected>All Transportation</option>
                <option value="T03,T04,T05">Truck</option>
                <option value="T06">Rail</option>
                <option value="T07,T08,T09,T10,T101">Water</option>
                <option value="T11">Air</option>
                <option value="T14">Parcel, USPS, or courier</option>
                <option value="T00">Other Undefined Modes</option>
            </select>
        </span>
        <span class="shade-by">
            <label class="label">Shade by</label>
            <select class="selectbox selectbox-mid" id="shade">
                <option value="ie" selected>Import and Export</option>
                <option value="food">Food Types</option>
                <option value="trans">Transportation Modes</option>
            </select>
        </span>
    </div>
    </form>
</div>
<div style="height:10px;">&nbsp;</div>
<div id="arcsAndDots">
    <div id="hoverState" style="top:285px;left:10px;display:none;" class="hoverState">
        <span id="hoverStateName">GA - Georgia</span><br>
        <span class="greyText keyUnits">In Billions of Pounds</span>
        <table style="border:none;width:100%;">
            <tr><td>
                <span class="greyText">Import</span><br>
                <span id="hoverImport">540</span>
            </td><td style="text-align: right;">
                <span class="greyText">Rank</span><br>
                <span class="orange" id="hoverImportRank">12</span>/51
            </td></tr>
            <tr><td>
                <span class="greyText">Export</span><br>
                <span id="hoverExport">1120</span>
            </td><td style="text-align: right;">
                <span class="greyText">Rank</span><br>
                <span class="orange" id="hoverExportRank">23</span>/51
            </td></tr>
        </table>
    </div>
    <svg id='arcGraph'>
        <g class='gray-arc'></g>
        <g class='gray-arc' id="selectedArc"></g>
    </svg>
    <div class="key">
        <svg width="230" height="15" class="sKey">
            <circle cx="3" cy="7" r="2.5" class="stateCircle"></circle>
            <circle cx="11" cy="7" r="4.5" class="stateCircle"></circle>
            <circle cx="23" cy="7" r="6.5" class="stateCircle"></circle>
            <text x="35" y="11" class="keyText viewSelectText">Shipment Weight</text>
            <rect x="120" y="2" width="11" height="11" class="keyBox import"></rect>
            <text x="138" y="11" class="keyText">Import</text>

            <rect x="180" y="2" width="11" height="11" class="keyBox export"></rect>
            <text x="198" y="11" class="keyText">Export</text>
        </svg>
    </div>
</div>
<div id="bottomRow">
    <div id="map">
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/1 -->
        <h2><span class="viewSelectText">Shipment Weight</span> by State, <span class="year">2012</span></h2>
        <div class="notes keyUnits">In Billions of Pounds</div>
        <div id="mapKey" class="key" style="padding: 10px;">
            <svg width="230" height="25">
                <text class="keyText" x="0" y="23">0</text>
                <text class="keyText" id="mapKey1" x="69" y="10">30</text>
                <text class="keyText" id="mapKey2" x="129" y="10">60</text>
                <text class="keyText" id="mapKey3" x="205" y="23">&gt; 90</text>
                <rect width="31" height="11" x="17" y="14" class="mapColor1"></rect>
                <rect width="31" height="11" x="47" y="14" class="mapColor2"></rect>
                <rect width="31" height="11" x="77" y="14" class="mapColor3"></rect>
                <rect width="31" height="11" x="107" y="14" class="mapColor4"></rect>
                <rect width="31" height="11" x="137" y="14" class="mapColor5"></rect>
                <rect width="30" height="11" x="167" y="14" class="mapColor6"></rect>
            </svg>
        </div>
        <div id="plotMap">
            <svg height="240" width="360">
                <g id="stateMapME" transform="translate(330,0)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">ME</text>
                </g>
                <g id="stateMapAK" transform="translate(0,30)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">AK</text>
                </g>
                <g id="stateMapVT" transform="translate(270,30)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">VT</text>
                </g>
                <g id="stateMapNH" transform="translate(300,30)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NH</text>
                </g>
                <g id="stateMapMA" transform="translate(330,30)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MA</text>
                </g>
                <g id="stateMapWA" transform="translate(30,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">WA</text>
                </g>
                <g id="stateMapMT" transform="translate(60,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MT</text>
                </g>
                <g id="stateMapND" transform="translate(90,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">ND</text>
                </g>
                <g id="stateMapSD" transform="translate(120,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">SD</text>
                </g>
                <g id="stateMapMN" transform="translate(150,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MN</text>
                </g>
                <g id="stateMapWI" transform="translate(180,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">WI</text>
                </g>
                <g id="stateMapMI" transform="translate(210,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MI</text>
                </g>
                <g id="stateMapNY" transform="translate(270,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NY</text>
                </g>
                <g id="stateMapCT" transform="translate(300,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">CT</text>
                </g>
                <g id="stateMapRI" transform="translate(330,60)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">RI</text>
                </g>
                <g id="stateMapOR" transform="translate(30,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">OR</text>
                </g>
                <g id="stateMapID" transform="translate(60,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">ID</text>
                </g>
                <g id="stateMapWY" transform="translate(90,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">WY</text>
                </g>
                <g id="stateMapNE" transform="translate(120,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NE</text>
                </g>
                <g id="stateMapIA" transform="translate(150,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">IA</text>
                </g>
                <g id="stateMapIL" transform="translate(180,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">IL</text>
                </g>
                <g id="stateMapIN" transform="translate(210,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">IN</text>
                </g>
                <g id="stateMapOH" transform="translate(240,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">OH</text>
                </g>
                <g id="stateMapPA" transform="translate(270,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">PA</text>
                </g>
                <g id="stateMapNJ" transform="translate(300,90)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NJ</text>
                </g>
                <g id="stateMapCA" transform="translate(0,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">CA</text>
                </g>
                <g id="stateMapNV" transform="translate(30,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NV</text>
                </g>
                <g id="stateMapUT" transform="translate(60,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">UT</text>
                </g>
                <g id="stateMapCO" transform="translate(90,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">CO</text>
                </g>
                <g id="stateMapKS" transform="translate(120,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">KS</text>
                </g>
                <g id="stateMapMO" transform="translate(150,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MO</text>
                </g>
                <g id="stateMapKY" transform="translate(180,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">KY</text>
                </g>
                <g id="stateMapWV" transform="translate(210,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">WV</text>
                </g>
                <g id="stateMapDC" transform="translate(240,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">DC</text>
                </g>
                <g id="stateMapMD" transform="translate(270,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MD</text>
                </g>
                <g id="stateMapDE" transform="translate(300,120)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">DE</text>
                </g>
                <g id="stateMapAZ" transform="translate(60,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">AZ</text>
                </g>
                <g id="stateMapNM" transform="translate(90,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NM</text>
                </g>
                <g id="stateMapOK" transform="translate(120,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">OK</text>
                </g>
                <g id="stateMapAR" transform="translate(150,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">AR</text>
                </g>
                <g id="stateMapTN" transform="translate(180,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">TN</text>
                </g>
                <g id="stateMapVA" transform="translate(210,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">VA</text>
                </g>
                <g id="stateMapNC" transform="translate(240,150)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">NC</text>
                </g>
                <g id="stateMapHI" transform="translate(0,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">HI</text>
                </g>
                <g id="stateMapTX" transform="translate(90,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">TX</text>
                </g>
                <g id="stateMapLA" transform="translate(120,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">LA</text>
                </g>
                <g id="stateMapMS" transform="translate(150,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">MS</text>
                </g>
                <g id="stateMapAL" transform="translate(180,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">AL</text>
                </g>
                <g id="stateMapGA" transform="translate(210,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">GA</text>
                </g>
                <g id="stateMapSC" transform="translate(240,180)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">SC</text>
                </g>
                <g id="stateMapFL" transform="translate(210,210)">
                    <rect width="29" height="29"></rect>
                    <text class="stateID" style="pointer-events: none;" x="14.5" y="14.5">FL</text>
                </g>
            </svg>
        </div>
    </div>
    <div id="foodClassBar">
        <h2>Food Classification, <span class="state">U.S.</span> <span class="year">2012</span></h2>
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/2 -->
        <!-- Complete using flot (http://www.flotcharts.org/flot/examples/stacking/index.html) or D3 -->
    </div>
    <div id="transportationBar">
        <h2>Transportation Mode, <span class="state">U.S.</span> <span class="year">2012</span></h2>
        <!-- https://github.gatech.edu/lklingman3/info-vis/issues/3 -->
        <!-- Complete using flot (http://www.flotcharts.org/flot/examples/stacking/index.html) or D3 -->
    </div>
</div>
</body>
</html>